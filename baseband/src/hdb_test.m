%% Consecutive zeros
assert(isequal(hdb([0 0 0], 3), [0 0 0]));
assert(isequal(hdb([0 0 0 0], 3), [0 0 0 +1]));
assert(isequal(hdb([0 0 0 0], 4), [0 0 0 0]));


%% The example on slide (ยง6.2.2.1, page 39)
assert(isequal( ...
    hdb([1 0 0 0 0 1 0 0 0 0 1 1 0 0 0 0 0 0 0 0 1 1], 3), ...
    [-1 0 0 0 -1 1 0 0 0 +1 -1 +1 -1 0 0 -1 +1 0 0 +1 -1 +1] ...
));


%% Set first mark
assert(isequal( ...
    hdb([0 1 1 0], 3, 'FirstMark', -1), ...
    [0 -1 +1 0] ...
));
assert(isequal( ...
    hdb([0 1 1 0], 3, 'FirstMark', +1), ...
    [0 +1 -1 0] ...
));


%% Set first violation and first mark
assert(isequal( ...
    hdb([0 0 0 0], 3, 'FirstMark', -1, 'FirstViolation', -1), ...
    [-1 0 0 -1] ...
));
assert(isequal( ...
    hdb([0 0 0 0], 3, 'FirstMark', -1, 'FirstViolation', +1), ...
    [0 0 0 +1] ...
));
assert(isequal( ...
    hdb([0 0 0 0], 3, 'FirstMark', -1, 'FirstViolation', 0), ...
    [0 0 0 +1] ...
));

assert(isequal( ...
    hdb([0 0 0 0], 3, 'FirstMark', +1, 'FirstViolation', -1), ...
    [0 0 0 -1] ...
));
assert(isequal( ...
    hdb([0 0 0 0], 3, 'FirstMark', +1, 'FirstViolation', +1), ...
    [+1 0 0 +1] ...
));
assert(isequal( ...
    hdb([0 0 0 0], 3, 'FirstMark', +1, 'FirstViolation', 0), ...
    [0 0 0 -1] ...
));


%% Examples on [Wikipedia](https://en.wikipedia.org/wiki/Modified_AMI_code#Examples)
% https://en.wikipedia.org/w/index.php?title=Modified_AMI_code&oldid=1103892316#Examples
assert(isequal( ...
    hdb([1 0 0 0 0 1 1 0], 3, 'FirstMark', +1, 'FirstViolation', -1), ...
    [+1 -1 0 0 -1 +1 -1 0] ...
));
assert(isequal( ...
    hdb([1 0 1 0 0 0 0 0 1 1 0 0 0 0 1 1 0 0 0 0 0 0 0 1], 3, 'FirstMark', +1, 'FirstViolation', -1), ...
    [+1 0 -1 0 0 0 -1 0 +1 -1 +1 0 0 +1 -1 +1 -1 0 0 -1 0 0 0 +1] ...
));
assert(isequal( ...
    hdb([1 0 1 0 0 0 0 1 0 0 0 0 1 1 0 0 0 0 1 1 1 0 0 0 0 1 1 1 1 0 0 0 0 1 0 1 0 0 0 0], 3, 'FirstMark', +1, 'FirstViolation', -1), ...
    [+1 0 -1 0 0 0 -1 +1 0 0 0 +1 -1 +1 -1 0 0 -1 +1 -1 +1 0 0 0 +1 -1 +1 -1 +1 -1 0 0 -1 +1 0 -1 +1 0 0 +1] ...
));
assert(isequal( ...
    hdb([1 0 0 0 0 0 0 0 0 0 0], 3, 'FirstMark', +1, 'FirstViolation', -1), ...
    [+1 -1 0 0 -1 +1 0 0 +1 0 0] ...
));
